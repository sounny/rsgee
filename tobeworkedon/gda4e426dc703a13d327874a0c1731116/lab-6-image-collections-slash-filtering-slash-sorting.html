<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Assignment: Lab 6 - Image Collections / Filtering / Sorting</title>
</head>
<body>
<p><em><strong>Lab Lecture Fall 2023 - <a href="https://ufl.zoom.us/rec/share/uYl15vuKhf8pZrt_TRN08maw4i7SltbJczhhWoVrt-sSFhhELirmGtI1OiV6avez.xqUjNFUT3OMPnm42?startTime=1693931924000" target="_blank">https://ufl.zoom.us/rec/share/uYl15vuKhf8pZrt_TRN08maw4i7SltbJczhhWoVrt-sSFhhELirmGtI1OiV6avez.xqUjNFUT3OMPnm42?startTime=1693931924000</a></strong></em></p>
<p><span><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/5262-Landsat-timeline-FNL-2.jpg" alt="a timeline of Landsat imagery " data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934712" data-api-returntype="File" loading="lazy"></span></p>
<p><em><strong>Figure - Timeline of the longest continuous remote sensing mission, LandSat</strong></em></p>
<p><span>The Landsat program from NASA and the United States Geological Survey (USGS) has launched a sequence of Earth observation satellites named Landsat 1, 2, etc. Landsats have been returning images since 1972, making that collection of images the longest continuous satellite-based observation of the Earth's surface. </span></p>
<p>The Landsat program has revolutionized remote sensing and land observation. The program was initially developed to improve the understanding of the Earth’s terrestrial and aquatic ecosystems, but its use quickly grew to encompass a wide range of fields, such as natural resource exploration, disaster preparedness, urban planning, and agricultural monitoring.</p>
<p>The Landsat satellites are designed to capture detailed images of the Earth’s surface on a regular basis with a spatial resolution of 30 meters per pixel in visible and near-infrared light bands, with additional infrared and thermal band capabilities. These images are then used to create highly accurate land cover maps, which can be used to track changes in land use over time. The program is continually being updated with improved capabilities, and today it can capture images with a spatial resolution of 15 meters per pixel. Additionally, Landsat data is freely available to the public, making it a valuable tool for both professional and amateur users.</p>
<p><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/landsat8_channels.png" alt="Channels of LandSat 8 Imagery" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934713" data-api-returntype="File" loading="lazy"></p>
<p><em><strong>Figure - Electromagnetic Specture and the Windows in the Atmosphere with the Bands for LandSat 8</strong></em></p>
<p>Landsat imagery has been used in a variety of ways since its inception, ranging from providing early warning of environmental disasters to studying long-term global change. The program has also been instrumental in helping scientists better understand the effects of climate change on natural resources by providing detailed data on land cover dynamics. Additionally, Landsat data also aids urban planners in understanding the dynamics of urbanization, as well as providing valuable insight into the agricultural sector.</p>
<p><span>We will now view images and basic information about one of the image collections that is still growing: collections of scenes taken by the Operational Land Imager aboard Landsat 8, which was launched in 2013.</span></p>
<ol style="list-style-type: decimal;">
<li><span>Open up Google Earth Engine Code: <a href="https://code.earthengine.google.com/https://code.earthengine.google.com/" target="_blank">https://code.earthengine.google.com/https://code.earthengine.google.com/</a></span></li>
<li><span>Copy and paste the following code into the center panel and click Run.</span></li>
<li>
<pre>/////<br>// View an Image Collection<br>/////<br><br>// Import the Landsat 8 Raw Collection.<br>var landsat8 = ee.ImageCollection('LANDSAT/LC08/C02/T1');<br><br>// Print the size of the Landsat 8 dataset.<br>print('The size of the Landsat 8 image collection is:', landsat8<br>.size());<br><br>// Try to print the image collection.<br>// WARNING! Running the print code immediately below produces an error because&nbsp;<br>// the Console can not print more than 5000 elements.<br>print(landsat8);<br><br>// Add the Landsat 8 dataset to the map as a mosaic. The collection is&nbsp;<br>// already chronologically sorted, so the most recent pixel is displayed.<br>Map.addLayer(landsat8,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; bands: ['B4', 'B3', 'B2'],<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 5000,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 15000<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'Landsat 8 Image Collection');<br><br></pre>
</li>
<li><span>&nbsp;While the enormous image catalog is accessed, it could take a couple of minutes to see the result in the Map area. You may note individual “scenes” being drawn, which equate to the way that the Landsat program partitions Earth into “paths” and “rows.” If it takes more than a couple of minutes to see the images, try zooming in to a specific area to speed up the process.</span></li>
<li><span><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%202.06.31%20AM.png" alt="screenshot of Landsat being drawn on Google Earth Engine" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934714" data-api-returntype="File" loading="lazy"></span></li>
<li><span>Note aboue rows and paths in LandSat:<span> Images from LandSat are then placed in a grid pattern to form the row and path system. A row is a sequence of Landsat images that are taken at the same latitude, while a path is a series of images taken at the same longitude. Paths and rows form a grid-like pattern across the Earth’s surface and are used by scientists to map and monitor different land features. Paths are numbered from west to east, starting at the 180-degree longitude line and incrementing by 1. The rows are numbered from south to north, starting at the equator and incrementing by 1.</span></span></li>
<li>Notice the high amount of cloud cover and the “layered” look. Zoom out if needed. This is because Earth Engine is drawing each of the images that make up the ImageCollection one on top of the other. The striped look is the result of how the satellite collects imagery. The overlaps between images and the individual nature of the images mean that these are not quite ready for analysis. We will learn how to get image analysis ready in future labs.&nbsp;</li>
<li>For now, examine the printed size on the Console. It will indicate that there are more than a million images in the dataset. If you return to this lab in the future, the number will be even larger since this active collection is continually growing as the satellite gathers more imagery. This is because LandSat is continuing to collect imagery that is digested into Earth Engine.&nbsp; What is great about this is that we can get very recent imagery through the image collections, as they are updated regularly and automatically by Google.</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%202.51.00%20AM.png" alt="screenshot showing the number of Landsat images in the collection" width="573" height="144" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934715" data-api-returntype="File" loading="lazy"></li>
<li>
<span>Note that printing the </span><span>ImageCollection</span><span> returned an error message. This is because calling </span><span>print</span><span> on an </span><span>ImageCollection</span><span> will write the name of every image in the collection to the </span><strong>Console</strong><span>. This is the result of an intentional safeguard within Earth Engine. We don’t want to see a million image names printed on the </span><strong>Console</strong><span>!</span>&nbsp;</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%205.59.46%20AM.png" alt="screenshot showing the error. " width="572" height="256" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934716" data-api-returntype="File" loading="lazy"></li>
<li>Edit your code to "comment out" the last two code commands. This will remove the call to Map.addLayer that drew every image and will remove the print statement that demanded more than 5000 elements. This will speed up your code in subsequent sections, and we do not need these two lines to run anymore, but we would like to save them for reference. Reminder that placing two forward slashes (//) at the beginning of a line will make it into a comment, and any commands on that line will not be executed.</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.03.07%20AM.png" alt="screenshot with the commented out code." data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934717" data-api-returntype="File" loading="lazy"></li>
<li>Now we will look out how to find out "the needle in the haystack." We will look at filtering.&nbsp; Basic approach to GEE is to add an image collection that brings in every image, then to filter the collection till you find the single image you are interested in. The ImageCollection data type in Earth Engine has multiple approaches to filtering, which helps to pinpoint the exact images you want to view or analyze from the larger collection. First, we will look at filtering by date.</li>
<li>filterDate allows us to narrow down the date range of the ImageCollection. Copy the following code and paste it after the previous code you had just commented out.&nbsp;
<pre>/////<br>// Filter an Image Collection<br>/////<br><br>// Filter the collection by date.<br>var landsatWinter = landsat8.filterDate('2020-12-01', '2021-03-01');<br><br>Map.addLayer(landsatWinter,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; bands: ['B4', 'B3', 'B2'],<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 5000,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 15000<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'Winter Landsat 8');<br><br>print('The size of the Winter Landsat 8 image collection is:',<br>&nbsp; &nbsp; landsatWinter.size());</pre>
</li>
<li>The result will load much faster than before because now we filtered by date and are working with less imagery.&nbsp; Notice that before, we had over a million images in our collection.&nbsp; After filtering, we has thousands of images.&nbsp;</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.07.39%20AM.png" alt="results from filtering by date" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934718" data-api-returntype="File" loading="lazy"></li>
<li>Now let's comment out the Map.addLayer that brought in the winter imagery before we move on.&nbsp; Again this is done by adding // before the lines of code you want to deactivate.&nbsp;</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.15.34%20AM.png" alt="Commented out code for winter imagary. " width="577" height="417" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934719" data-api-returntype="File" loading="lazy"></li>
<li>Now let's look at Filter by Location. To folder by location, we will use the filtering tool is <strong>filterBounds</strong>. This filter is based on a location—for example, a point, polygon, or other geometry. Copy and paste the code below to filter and add to the map the winter images from the Landsat 8 Image Collection to a point in Gainesville, Florida, USA.</li>
<li>
<pre>/////<br>//Filter by location &nbsp; &nbsp;<br>/////<br><br>// Create an Earth Engine Point object.<br>var pointFL = ee.Geometry.Point([-82.32, 29.65]);<br><br>// Filter the collection by location using the point.<br>var landsatFL = landsatWinter.filterBounds(pointFL);<br>Map.addLayer(landsatFL,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; bands: ['B4', 'B3', 'B2'],<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 5000,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 15000<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'FL Landsat 8');<br><br>// Add the point to the map to see where it is.<br>Map.addLayer(pointFL, {}, 'Point FL');<br><br>print('The size of the Gainesville Winter Landsat 8 image collection is: ',<br>&nbsp; &nbsp; landsatFL.size());<br><br></pre>
</li>
<li>Note below the Map.addLayer function to add the pointFL to the map with an empty dictionary {} for the visParams argument. This only means that we are not specifying visualization parameters for this element, and it is being added to the map with the default parameters.</li>
<li>Run the Code. Note now we can see that only images that intersect our point have been selected—Zoom in or out as needed.</li>
<li>Note the printed size of the Florida winter collection—we only have 12 images.</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.21.57%20AM.png" alt="screenshot of the resulting GEE code" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934720" data-api-returntype="File" loading="lazy"></li>
<li>
<span>The final operation we will explore is the </span><span>first</span><span> function. This selects the first image in an </span><span>ImageCollection</span><span>. This allows us to place a single image on the screen for inspection. Copy and paste the code below to select and view the first image of the Florida Winter Landsat 8 Image Collection. In this case, because the images are stored in time order in the </span><span>ImageCollection</span><span>, it will select the earliest image in the set.</span>
</li>
<li><span><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.24.50%20AM.png" alt="filtered to a single image" data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934721" data-api-returntype="File" loading="lazy"></span></li>
<li><span>Notice that the image that we selected is very cloudy.&nbsp; Normally this can be a big problem for analysis and we would prefer to have an image with no clouds.&nbsp; Luckily each image in LandSat image collection has a cloud cover rating that we can use to get an image without clouds. The basic approach is the sort the imagecollection by cloud cover and then to add the first image to the map. Copy and past the following code below.&nbsp;</span></li>
<li>
<pre>//Sort the image collecction by cloud cover<br>var landsatSort = landsatFL.sort('CLOUD_COVER');<br><br>// Select the first image in the filtered collection.<br>var landsatFirstSort = landsatSort.first();<br><br>// Display the first image in the filtered collection.<br>Map.centerObject(landsatFirstSort, 7);<br>Map.addLayer(landsatFirstSort,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; bands: ['B4', 'B3', 'B2'],<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 5000,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 15000<br>&nbsp; &nbsp; },<br>  &nbsp; 'Sort Landsat 8');</pre>
</li>
<li>When you hit run now, you will see that you have a single LandSat image with no cloud cover, filtered for Gainesville during the winter of 2020-2021.</li>
<li><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-02-17%20at%206.32.41%20AM.png" alt="Resulting image." data-api-endpoint="https://ufl.instructure.com/api/v1/courses/489224/files/79934722" data-api-returntype="File" loading="lazy"></li>
<li><em>Here is a link to the full code: <a href="https://code.earthengine.google.com/63a62bb95d997e06fda0f38141ca4aa4https://code.earthengine.google.com/63a62bb95d997e06fda0f38141ca4aa4" target="_blank">https://code.earthengine.google.com/63a62bb95d997e06fda0f38141ca4aa4https://code.earthengine.google.com/63a62bb95d997e06fda0f38141ca4aa4</a></em></li>
<li><strong>Challenge: Now, using the filtering method, turn in code that displays a single cloud-free image of the Champs De Mars in Paris, France, in the summer of 2022 (June-Auguest).&nbsp; Display the image in Natural Color and in Color Infrared. Submit the URL for your code.&nbsp; Follow good coding practices and comment on your code with details of what you did.&nbsp;</strong></li>
</ol>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>