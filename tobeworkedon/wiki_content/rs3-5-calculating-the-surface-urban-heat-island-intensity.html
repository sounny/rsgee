<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>RS3 - 5 - Calculating the Surface Urban Heat Island Intensity</title>
<meta name="identifier" content="gd9ecee14bd218002f561b9953fed212d"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<p><span>Since the SUHI is the temperature difference between the urban area and the rural reference, we will calculate summary temperature values for the urban boundary and the different versions of rural reference using the Landsat and MODIS LST.&nbsp;</span></p>
<table>
<tbody>
<tr>
<td>
<pre><span>// Define function to reduce regions and summarize pixel values </span><span><br></span><span>// to get mean LST for different cases.</span><span><br></span><strong>function</strong><span> polygonMean(feature) {</span><span><br></span><span><br></span><span>&nbsp; &nbsp; </span><span>// Calculate spatial mean value of LST for each case </span><span><br></span><span>&nbsp; &nbsp; </span><span>// making sure the pixel values are converted to °C from Kelvin.</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstUrb = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstUrbMask = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstUrbPix = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>500</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstLandsatUrbPix = landsatComp.</span><span>updateMask</span><span>(notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstRurPix = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanNonUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>500</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstLandsatRurPix = landsatComp.</span><span>updateMask</span><span>(notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanNonUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span><br></span><span>&nbsp; &nbsp; </span><span>// Return each feature with the summarized LSY values as properties.</span><span><br></span><span>&nbsp; &nbsp; </span><strong>return</strong><span> feature.</span><span>set</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_urb'</span><span>: reducedLstUrb.</span><span>get</span><span>(</span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_urb_mask'</span><span>: reducedLstUrbMask.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_urb_pix'</span><span>: reducedLstUrbPix.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_rur_pix'</span><span>: reducedLstRurPix.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'Landsat_LST_urb_pix'</span><span>: reducedLstLandsatUrbPix.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'Landsat_LST_rur_pix'</span><span>: reducedLstLandsatRurPix.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST'</span><span>)</span><span><br></span><span>&nbsp; &nbsp; });</span><span><br></span><span>}</span><span><br></span><span><br></span><span>// Map the function over the urban boundary to get mean urban and rural LST </span><span><br></span><span>// for cases without any explicit buffer-based boundaries.</span><span><br></span><strong>var</strong><span> reduced = regionInt.</span><span>map</span><span>(polygonMean);</span></pre>
</td>
</tr>
</tbody>
</table>
<p><span>As you know from the code above, we extract urban temperature from MODIS (</span><span>'MODIS_LST_urb</span><span>) and from Landsat and MODIS (</span><span>'MODIS_LST_urb_pix'</span><span> and </span><span>'Landsat_LST_urb_pix'</span><span>) after considering only the urban pixels within the boundary.</span><span><br></span></p>
<p><span>Corresponding values are also extracted from the rural reference (including using only rural reference pixels within the urban boundary). For the buffered regions (both using constant width and variable width), we define and call another function.</span></p>
<table>
<tbody>
<tr>
<td>
<pre><span>// Define a function to reduce region and summarize pixel values </span><span><br></span><span>// to get mean LST for different cases.</span><span><br></span><strong>function</strong><span> refMean(feature) {</span><span><br></span><span>&nbsp; &nbsp; </span><span>// Calculate spatial mean value of LST for each case </span><span><br></span><span>&nbsp; &nbsp; </span><span>// making sure the pixel values are converted to °C from Kelvin.</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstRur = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>var</strong><span> reducedLstRurMask = lstFinal.</span><span>subtract</span><span>(</span><span>273.15</span><span>).</span><span>updateMask</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; notWater)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanNonUrban)</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>reduceRegion</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reducer: </span><span>ee</span><span>.</span><span>Reducer.mean</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; geometry: feature.</span><span>geometry</span><span>(),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale: </span><span>30</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; });</span><span><br></span><span>&nbsp; &nbsp; </span><strong>return</strong><span> feature.</span><span>set</span><span>({</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_rur'</span><span>: reducedLstRur.</span><span>get</span><span>(</span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; </span><span>'MODIS_LST_rur_mask'</span><span>: reducedLstRurMask.</span><span>get</span><span>(</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>'LST_Day_1km'</span><span>),</span><span><br></span><span>&nbsp; &nbsp; });</span><span><br></span><span>}</span><span><br></span><span><br></span><span>// Map the function over the constant buffer rural reference boundary one.</span><span><br></span><strong>var</strong><span> reducedRural = </span><span>ee</span><span>.</span><span>FeatureCollection</span><span>(ruralRef).</span><span>map</span><span>(refMean);</span><span><br></span><span><br></span><span>// Map the function over the standardized rural reference boundary.</span><span><br></span><strong>var</strong><span> reducedRuralStd = ruralRefStd.</span><span>map</span><span>(refMean);</span><span><br></span><span><br></span><span>print</span><span>(</span><span>'reduced'</span><span>, reduced);</span><span><br></span><span>print</span><span>(</span><span>'reducedRural'</span><span>, reducedRural);</span><span><br></span><span>print</span><span>(</span><span>'reducedRuralStd'</span><span>, reducedRuralStd);</span></pre>
</td>
</tr>
</tbody>
</table>
<p><span>We can print the newly created feature collections to review these values for the different cases. Even though absolute MODIS and Landsat urban LSTs are different (29 for Landsat and 34 for MODIS), the SUHI is similar (3.6 C for MODIS and 4.8 C from Landsat). As one might expect, when only urban pixels are considered within the boundary, the average LST is higher (and lower for rural LST).</span><span><br></span></p>
<p><span>The SUHI variability within the city can then be displayed by subtracting the rural LST from the total LST:</span></p>
<table>
<tbody>
<tr>
<td>
<pre><span>// Display SUHI variability within the city.</span><span><br></span><strong>var</strong><span> suhi = landsatComp</span><span><br></span><span>&nbsp; &nbsp; .</span><span>updateMask</span><span>(urbanUrban)</span><span><br></span><span>&nbsp; &nbsp; .</span><span>subtract</span><span>(</span><span>ee</span><span>.</span><span>Number</span><span>(</span><span>ee</span><span>.</span><span>Feature</span><span>(reduced.</span><span>first</span><span>())</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; .</span><span>get</span><span>(</span><span>'Landsat_LST_rur_pix'</span><span>)));</span><span><br></span><span><br></span><span>Map</span><span>.</span><span>addLayer</span><span>(suhi, {</span><span><br></span><span>&nbsp; &nbsp; palette: [</span><span>'blue'</span><span>, </span><span>'white'</span><span>, </span><span>'red'</span><span>],</span><span><br></span><span>&nbsp; &nbsp; min: </span><span>2</span><span>,</span><span><br></span><span>&nbsp; &nbsp; max: </span><span>8</span><span><br></span><span>}, </span><span>'SUHI'</span><span>);</span></pre>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><em><span><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-11-09%20at%2011.33.15%E2%80%AFAM.png" alt="Screenshot 2023-11-09 at 11.33.15 AM.png" loading="lazy"></span><strong>Figure:</strong><span> Spatial variability in SUHI for the period of interest for New Haven, Connecticut. Red pixels show higher values, and blue pixels show lower values.</span></em></p>
<div id="gtx-trans" style="position: absolute; left: 179px; top: 2922.24px;"></div>
</body>
</html>