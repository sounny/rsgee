<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>GSO-4-Joining Collections</title>
<meta name="identifier" content="g2e40913d9f7e2328f609ce56d281ab74"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<p><span dir="ltr"><span>As part of our analysis, we need the snow cover tile description and the zenith angle.&nbsp; The Sensor zenith angle must come from another MODIS dataset, as it is not included in the standard MOD10A1 dataset.&nbsp; Fortunately, Google Earth Engine also contains the MOD09GA dataset.&nbsp; If we call it in and look at the bands it contains per the previous example, we can see the SensorZenith band (band 2 in the image below).</span></span></p>
<p><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/MOD09GA.png" alt="SensorZenith band in band 2" loading="lazy"></p>
<p><span dir="ltr"><span>Our goal is to get the sensor zenith angle band from MOD09GA into the imagery that contains our snow cover data.&nbsp; To select a particular band to work with, we can use the .select() method, like so.&nbsp;</span></span></p>
<pre>//Selecting and renaming bands<br><br>var MOD09GA = ee.ImageCollection('MOD09GA').select('SensorZenith')<br>.filterDate('2005-10-01', '2006-09-30');<br><br>print(MOD09GA);<a class="external" href="https://code.earthengine.google.com/de7b19f2f283d8922ed93532b8417ead" target="_blank"><br><span class="external_link_icon" role="presentation"><span class="screenreader-only">Links to an external site.</span></span></a></pre>
<p><a href="https://code.earthengine.google.com/46e58361354b644577374a3aa82856a4" target="_blank">https://code.earthengine.google.com/46e58361354b644577374a3aa82856a4</a>&nbsp;</p>
<p><span><a class="external" href="https://sites.google.com/site/earthengineapidocs/joins" target="_blank">Joining<span class="external_link_icon" role="presentation"><span class="screenreader-only">Links to an external site.</span></span></a>&nbsp;Two collections require a common property between the two, just as it does in standard GIS software. &nbsp;In this case, the best way to join the collections is to join them based on their acquisition times, using the “system:Time_Start” property as the filter.&nbsp; If you look at the various types of joins in the documentation, you will see that there are a few ways to go about doing this but we will use the join.inner(). &nbsp;The code to join the two datasets together looks like such.&nbsp;</span></p>
<pre>//Joining two collections<br><br>// First, we define the two datasets, selecting the bands we are interested in<br>var MOD09GA = ee.ImageCollection('MOD09GA').select('SensorZenith')<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.filterDate('2005-10-01', '2005-10-31');<br>var MOD10A1 = ee.ImageCollection('MOD10A1').select('Snow_Cover_Daily_Tile')<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.filterDate('2005-10-01', '2005-10-31');<br><br>// Define the join and filter<br>var Join = ee.Join.inner();<br>var FilterOnStartTime = ee.Filter.equals({'leftField': 'system:time_start',&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'rightField': 'system:time_start'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br>// Join the two collections, passing entries through the filter<br>var JoinedMODIS = Join.apply(MOD09GA, MOD10A1, FilterOnStartTime);<br><br>print(JoinedMODIS);</pre>
<div>
<div><a href="https://ee-api.appspot.com/1909844aadf7ddb1d507ddff4a5bf75f" target="_blank"><span>https://code.earthengine.google.com/89757451f7d8d166777a5be5a4225108</span></a></div>
</div>
<p><span>Congratulations, we've just joined two MODIS collections, and it took less than 20 lines of code to do so! &nbsp;However, if you print the resulting collection, you get something like this...</span></p>
<div><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-11-02%20at%209.51.57%E2%80%AFAM.png" alt="Screenshot of print results" loading="lazy"></div>
<div><span>&nbsp;</span></div>
<div><span>The Image Collection has now become a FeatureCollection, and all of the features need to include the bands we want. &nbsp;Instead, they are in the columns "primary" and "secondary," as explained in the documentation for the join.&nbsp; </span><span>To return this to a format that we can work with, we need to run a function across the FeatureCollection, creating a new image that has the bands in the primary column and the secondary column. &nbsp;</span></div>
<div>
<pre>//Joining two collections<br><br>// A function to merge the bands together after a join<br>// the bands are referred to as the 'primary' and 'secondary' properties<br>var MergeBands = function(aRow) {<br>&nbsp; var anImage = ee.Image.cat(aRow.get('primary'), aRow.get('secondary'));<br>&nbsp; return anImage;<br>};<br><br>// First, we define the two datasets, selecting the bands we are interested in<br>var MOD09GA = ee.ImageCollection('MOD09GA').select('SensorZenith')<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.filterDate('2005-10-01', '2005-10-31');<br>var MOD10A1 = ee.ImageCollection('MOD10A1').select('Snow_Cover_Daily_Tile')<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.filterDate('2005-10-01', '2005-10-31');<br><br>// Define the join and filter<br>var Join = ee.Join.inner();<br>var FilterOnStartTime = ee.Filter.equals({'leftField': 'system:time_start',&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'rightField': 'system:time_start'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br>// Join the two collections, passing entries through the filter<br>var JoinedMODIS = Join.apply(MOD09GA, MOD10A1, FilterOnStartTime);<br><br>print(JoinedMODIS);<br><br>var MergedMODIS = JoinedMODIS.map(MergeBands);<br><br>print(MergedMODIS);</pre>
</div>
<div><a href="https://code.earthengine.google.com/991feec0b5548702fa411b57e6c7f8d6" target="_blank">https://code.earthengine.google.com/991feec0b5548702fa411b57e6c7f8d6</a></div>
<div><em><strong>Go ahead and run that code. &nbsp;Note the difference between the two collections. &nbsp;</strong></em></div>
<div><span><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/Screenshot%202023-11-02%20at%209.55.46%E2%80%AFAM.png" alt="Screenshot 2023-11-02 at 9.55.46 AM.png" loading="lazy"></span></div>
<div><span>Now that we have a function that joins the two collections, we need to mask out pixels that have a sensor zenith angle greater than 25<sup>o</sup></span></div>
</body>
</html>