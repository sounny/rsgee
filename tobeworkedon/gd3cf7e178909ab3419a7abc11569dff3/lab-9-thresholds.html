<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Assignment: Lab 9 - Thresholds</title>
</head>
<body>
<p><span><a class="ig-title title item_link" title="Lecture - Fall 2023 - Lab 9" href="$CANVAS_COURSE_REFERENCE$/modules/items/g323d0ccfb27cc614df462af9d6f71382">Lecture - Fall 2023 - Lab 9</a></span></p>
<p><span><a class="ig-title title item_link" title="Lecture - Spring 2023 - Lab 9 - Thresholds and boolean logic, simple classification" href="$CANVAS_COURSE_REFERENCE$/modules/items/gcac52cc42116cf58759d4bac54617605">Lecture - Spring 2023 - Lab 9 - Thresholds and boolean logic, simple classification</a></span></p>
<p><span>In this lab, we will extend the skills acquired in Lab<a title="Lab 8 - Band Arithmetic - NDVI" href="$CANVAS_OBJECT_REFERENCE$/assignments/ge84feaef9c7ad6da362a5a1b5253bdcb?wrap=1">&nbsp;8 - Band Arithmetic - NDVI</a>, to create categorized images using logical operators based on a threshold value. After learning how to manipulate images using band arithmetic to yield continuous values, such as the Normalized Difference Vegetation Index (NDVI), we will now focus on categorizing these continuous values into distinct classes. Utilizing Google Earth Engine's suite of Boolean and conditional operators, the lab will guide you through classifying NDVI values to distinguish between vegetated and non-vegetated areas.&nbsp;</span></p>
<p>Specifically, we will:</p>
<ol>
<li>Explore the difference between continuous and categorical data, emphasizing their applications in remote sensing.</li>
<li>Implement a basic threshold to create a binary map separating vegetated and non-vegetated regions.</li>
<li>Use advanced techniques like <code>.where</code> and <code>remap</code> to create a more nuanced categorized image, distinguishing between water, non-forest, and forest areas.</li>
</ol>
<h3>Background: Continuous vs. Categorical Data</h3>
<p><strong>Continuous Data</strong>: This type of data is measured on a continuous scale and can take on any value within a given range. In the context of remote sensing, NDVI is a good example of continuous data. The NDVI values can range from -1 to 1, offering a high level of granularity. Statistical methods like mean, standard deviation, and regression are suitable for analyzing continuous data.</p>
<p><strong>Categorical Data</strong>: Categorical data falls into distinct categories and is often represented by labels or numbers with no mathematical meaning. In remote sensing, this would involve taking continuous data like NDVI and categorizing it into groups, such as "vegetated" and "non-vegetated," based on certain thresholds. Frequency tables, chi-square tests, and contingency tables are used for analyzing categorical data.</p>
<h3>Logical Operators for Categorization</h3>
<p>We will use Google Earth Engine to implement thresholds and categorize NDVI values. Logical operators like 'greater than' (gt), 'less than' (lt), and 'equal to' (eq) will be employed to separate the NDVI image into two categories: “no vegetation” or “vegetation.” This simplification can be invaluable for certain types of analyses, like determining the proportion of a city that is vegetated.</p>
<h3>Advanced Techniques: <code>.where</code> and <code>remap</code>
</h3>
<p>To add nuance to our categorization, Earth Engine's <code>.where</code> method will be used. This allows us to conditionally evaluate and categorize pixels based on multiple thresholds, thus splitting our NDVI image into more than two categories. We will also explore the <code>remap</code> method to change specific values in an image, offering flexibility in handling categorical datasets.</p>
<h3>Tasks</h3>
<ol style="list-style-type: decimal;">
<li>
<span>Implementing a threshold uses a number (the threshold value) and logical operators to help us partition the variability of images into categories. For example, please remember our map of NDVI. High amounts of vegetation have NDVI values near 1, and non-vegetated areas are near 0. If we want to see what areas of the map have vegetation, we can use a threshold to generalize the NDVI value in each pixel as either “no vegetation” or “vegetation”. That is a substantial simplification, to be sure, but it can help us better comprehend the rich variation on the Earth’s surface. This type of categorization may be useful if, for example, we want to look at the proportion of a city that is vegetated.</span> <span>Let’s create a Sentinel-2 map of NDVI near Seattle, Washington, USA. Enter the code below in a new script.</span>
</li>
<li>
<pre>// Create an NDVI image using Sentinel 2.<br>var seaPoint = ee.Geometry.Point(-122.2040, 47.6221);<br>var seaImage = ee.ImageCollection('COPERNICUS/S2')<br>&nbsp; &nbsp; .filterBounds(seaPoint)<br>&nbsp; &nbsp; .filterDate('2020-08-15', '2020-10-01')<br>&nbsp; &nbsp; .first();<br><br>var seaNDVI = seaImage.normalizedDifference(['B8', 'B4']);<br><br>// And map it.<br>Map.centerObject(seaPoint, 10);<br>var vegPalette = ['red', 'white', 'green'];<br>Map.addLayer(seaNDVI,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; min: -1,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 1,<br>&nbsp; &nbsp; &nbsp; &nbsp; palette: vegPalette<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'NDVI Seattle');</pre>
</li>
<li>
<p>Inspect the image. We can see that vegetated areas are darker green while non-vegetated locations are white and water is pink. If we use the Inspector to query our image, we can see that parks and other forested areas have an NDVI of about 0.5. Thus, it would make sense to define areas with NDVI values greater than 0.5 as forested, and those below that threshold as not forested.</p>
</li>
<li>
<p>Now let’s define that value as a threshold and use it to threshold our vegetated areas.&nbsp;</p>
</li>
<li>
<pre><span>// Implement a threshold.</span><span><br></span><strong>var</strong><span> seaVeg = seaNDVI.</span><span>gt</span><span>(</span><span>0.5</span><span>);</span><span><br></span><span><br></span><span>// Map the threshold.</span><span><br></span><span>Map</span><span>.</span><span>addLayer</span><span>(seaVeg,</span><span><br></span><span>&nbsp; &nbsp; {</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; min: </span><span>0</span><span>,</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; max: </span><span>1</span><span>,</span><span><br></span><span>&nbsp; &nbsp; &nbsp; &nbsp; palette: [</span><span>'white'</span><span>, </span><span>'green'</span><span>]</span><span><br></span><span>&nbsp; &nbsp; },</span><span><br></span><span>&nbsp; &nbsp; </span><span>'Non-forest vs. Forest'</span><span>);</span></pre>
</li>
<li>
<p><span>The </span><span>gt</span><span> method is from the family of Boolean operators—that is, </span><span>gt</span><span> is a function that performs a test in each pixel and returns the value 1 if the test evaluates to true, and 0 otherwise. Here, for every pixel in the image, it tests whether the NDVI value is greater than 0.5. When this condition is met, the layer </span><span>seaVeg</span><span> gets the value 1. When the condition is false, it receives the value 0.&nbsp;</span></p>
</li>
<li><span>Use the <strong>Inspector</strong> tool to explore this new layer. If you click on a green location, that NDVI should be greater than 0.5. If you click on a white pixel, the NDVI value should be equal to or less than 0.5. </span></li>
<li>
<p><span>Other operators in this Boolean family include less than (</span><span>lt</span><span>), less than or equal to (</span><span>lte</span><span>), equal to (</span><span>eq</span><span>), not equal to (</span><span>neq</span><span>), and greater than or equal to (</span><span>gte</span><span>) and more.&nbsp;</span></p>
</li>
<li><em><strong>using .where</strong></em></li>
<li>
<p><span>A binary map classifying NDVI is very useful. However, there are situations where you may want to split your image into more than two bins. Earth Engine provides a tool, the </span><span>where</span><span> method, that conditionally evaluates to true or false within each pixel depending on the outcome of a test. This is analogous to an </span><i><span>if</span></i><span> statement was seen commonly in other languages. However, we avoid using the JavaScript if statement to perform this logic when programming for Earth Engine</span><span>. Importantly, JavaScript </span><i><span>if</span></i><span> commands are not calculated on Google’s servers, and can create serious problems when running your code—in effect, the servers try to ship all of the information to be executed to your own computer’s browser, which is very underequipped for such enormous tasks. Instead, we use the </span><span>where</span><span> clause for conditional logic</span></p>
</li>
<li>
<p><span>Suppose instead of splitting the forested areas from the non-forested areas in our NDVI, we want to split the image into likely water, non-forested, and forested areas. We can use </span><span>where</span><span> and thresholds of -0.1 and 0.5. We will start by creating an image using </span><span>ee</span><span>.</span><span>Image</span><span>. We then clip the new image to cover the same area as our </span><span>seaNDVI</span><span> layer.</span></p>
</li>
<li>
<pre><span>// Implement .where.<br>// Create a starting image with all values = 1.<br><strong>var</strong> seaWhere = ee.Image(1)<br>&nbsp; &nbsp; // Use clip to constrain the size of the new image.<br>&nbsp; &nbsp; .clip(seaNDVI.geometry());<br><br>// Make all NDVI values less than -0.1 equal 0.<br>seaWhere = seaWhere.where(seaNDVI.lte(-0.1), 0);<br><br>// Make all NDVI values greater than 0.5 equal 2.<br>seaWhere = seaWhere.where(seaNDVI.gte(0.5), 2);<br><br>// Map our layer that has been divided into three classes.<br>Map.addLayer(seaWhere,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 0,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 2,<br>&nbsp; &nbsp; &nbsp; &nbsp; palette: ['blue', 'white', 'green']<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'Water, Non-forest, Forest');</span></pre>
</li>
<li>
<p><span>There are a few exciting things to note about this code that you may not have seen before. First, we’re not defining a new variable for each </span><span>where</span><span> call. As a result, we can perform many </span><span>calls without creating a new variable each time and needing to keep track of them. Second, when we started the starting image, we set the value to 1. This means we could easily set the bottom and top values with one </span><span>where</span><span> clause each. Finally, while we did not do it here, we can combine multiple </span><span>where</span><span> clauses using </span><span>and</span> <span>or</span><span>. For example, we could identify pixels with an intermediate level of NDVI using </span><span>seaNDVI.</span><span>gte</span><span>(</span><span>-0.1</span><span>).</span><span>and</span><span>(seaNDVI.</span><span>lt</span><span>(</span><span>0.5</span><span>))</span><span>.</span></p>
</li>
<li>
<p><span>Finally, lets do some Remapping that takes specific values in an image and assigns them a different value. This is particularly useful for categorical datasets. </span><span>Let’s use the </span><span>remap</span><span> method to change the values for our </span><span>seaWhere</span><span> layer. Note that since we’re changing the middle value to be the largest, we’ll also need to adjust our palette.</span></p>
</li>
<li>
<pre><span>// Implement remapping.<br>// Remap the values from the seaWhere layer.<br><strong>var</strong> seaRemap = seaWhere.remap([0, 1, 2], // Existing values.<br>&nbsp; &nbsp; [9, 11, 10]); // Remapped values.<br><br>Map.addLayer(seaRemap,<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; min: 9,<br>&nbsp; &nbsp; &nbsp; &nbsp; max: 11,<br>&nbsp; &nbsp; &nbsp; &nbsp; palette: ['blue', 'green', 'white']<br>&nbsp; &nbsp; },<br>&nbsp; &nbsp; 'Remapped Values');</span></pre>
</li>
<li><span>Use the inspector to compare values between our original seaWhere (displayed as Water, Non-Forest, Forest) and the seaRemap, marked as “Remapped Values.” Click on a forested area to see that the Remapped Values should be 10, instead of 2.</span></li>
<li><em><strong>Submit the URL to your code with well-commented code that explains the different aspects of this lab. (50 points)</strong></em></li>
</ol>
</body>
</html>